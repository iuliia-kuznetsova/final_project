{"timestamp": "2026-01-14 21:24:15,252", "module": "modelling_ovr", "level": "INFO", "message": "Logging to /home/mle-user/mle_projects/final_project/logs/logs_modelling_ovr.json setup completed"}
{"timestamp": "2026-01-14 21:26:34,366", "module": "modelling_ovr", "level": "INFO", "message": "Train data loaded: X_train=1,152,814 rows x 77 columns, y_train=1,152,814 rows x 24 columns"}
{"timestamp": "2026-01-14 21:26:34,367", "module": "modelling_ovr", "level": "INFO", "message": "Test data loaded: X_test=85,995 rows x 77 columns, y_test=85,995 rows x 24 columns"}
{"timestamp": "2026-01-14 21:26:34,369", "module": "modelling_ovr", "level": "INFO", "message": "MLflow tracking URI: http://localhost:5000"}
{"timestamp": "2026-01-14 21:26:35,064", "module": "modelling_ovr", "level": "INFO", "message": "MLflow experiment set to: bank_products_recommendation"}
{"timestamp": "2026-01-14 21:26:35,064", "module": "modelling_ovr", "level": "INFO", "message": "OvRGroupModel initialized"}
{"timestamp": "2026-01-14 21:26:35,064", "module": "modelling_ovr", "level": "INFO", "message": "Hyperparameters optimization settings: n_splits=3, max_iter=300, early_stop=30"}
{"timestamp": "2026-01-14 21:26:35,064", "module": "modelling_ovr", "level": "INFO", "message": "Models training settings: boosting=Plain, border_count=128, threads=-1"}
{"timestamp": "2026-01-14 21:26:35,064", "module": "modelling_ovr", "level": "INFO", "message": "Feature selection settings: enabled=True, min_importance=0.001"}
{"timestamp": "2026-01-14 21:26:47,414", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-14 21:26:47,414", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Categorical features and their indices retrieved"}
{"timestamp": "2026-01-14 21:26:47,414", "module": "modelling_ovr", "level": "INFO", "message": "Categorical features: ['ind_empleado', 'pais_residencia', 'sexo', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'canal_entrada', 'indfall', 'cod_prov', 'ind_actividad_cliente', 'segmento', 'ind_ahor_fin_ult1_lag3', 'ind_aval_fin_ult1_lag3', 'ind_cco_fin_ult1_lag3', 'ind_cder_fin_ult1_lag3', 'ind_cno_fin_ult1_lag3', 'ind_ctju_fin_ult1_lag3', 'ind_ctma_fin_ult1_lag3', 'ind_ctop_fin_ult1_lag3', 'ind_ctpp_fin_ult1_lag3', 'ind_deco_fin_ult1_lag3', 'ind_ahor_fin_ult1_lag6', 'ind_aval_fin_ult1_lag6', 'ind_cco_fin_ult1_lag6', 'ind_cder_fin_ult1_lag6', 'ind_cno_fin_ult1_lag6', 'ind_ctju_fin_ult1_lag6', 'ind_ctma_fin_ult1_lag6', 'ind_ctop_fin_ult1_lag6', 'ind_ctpp_fin_ult1_lag6', 'ind_deco_fin_ult1_lag6']"}
{"timestamp": "2026-01-14 21:26:47,414", "module": "modelling_ovr", "level": "INFO", "message": "Categorical feature indices: [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60]"}
{"timestamp": "2026-01-14 21:26:50,072", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Feature selection completed"}
{"timestamp": "2026-01-14 21:26:50,072", "module": "modelling_ovr", "level": "INFO", "message": "Number of features kept: 27 out of 77"}
{"timestamp": "2026-01-14 21:26:50,072", "module": "modelling_ovr", "level": "INFO", "message": "Dropped low-importance features: ['ind_nom_pens_ult1', 'ind_aval_fin_ult1_lag3', 'ind_ctpp_fin_ult1_lag3', 'sexo', 'cod_prov', 'ind_ctma_fin_ult1_lag6', 'indfall', 'ind_deco_fin_ult1_acquired_recently', 'indresi', 'n_products_lag6']..."}
{"timestamp": "2026-01-14 21:26:50,358", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Categorical features and their indices retrieved"}
{"timestamp": "2026-01-14 21:26:50,358", "module": "modelling_ovr", "level": "INFO", "message": "Categorical features: ['ind_empleado', 'pais_residencia', 'sexo', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'canal_entrada', 'indfall', 'cod_prov', 'ind_actividad_cliente', 'segmento', 'ind_ahor_fin_ult1_lag3', 'ind_aval_fin_ult1_lag3', 'ind_cco_fin_ult1_lag3', 'ind_cder_fin_ult1_lag3', 'ind_cno_fin_ult1_lag3', 'ind_ctju_fin_ult1_lag3', 'ind_ctma_fin_ult1_lag3', 'ind_ctop_fin_ult1_lag3', 'ind_ctpp_fin_ult1_lag3', 'ind_deco_fin_ult1_lag3', 'ind_ahor_fin_ult1_lag6', 'ind_aval_fin_ult1_lag6', 'ind_cco_fin_ult1_lag6', 'ind_cder_fin_ult1_lag6', 'ind_cno_fin_ult1_lag6', 'ind_ctju_fin_ult1_lag6', 'ind_ctma_fin_ult1_lag6', 'ind_ctop_fin_ult1_lag6', 'ind_ctpp_fin_ult1_lag6', 'ind_deco_fin_ult1_lag6']"}
{"timestamp": "2026-01-14 21:26:50,358", "module": "modelling_ovr", "level": "INFO", "message": "Categorical feature indices: [0, 1, 4, 8, 9, 11, 12, 20, 24, 25, 26]"}
{"timestamp": "2026-01-14 21:26:50,358", "module": "modelling_ovr", "level": "INFO", "message": "Data after feature selection: |Total products: 24 |Total features: 27 |Categorical features: 11"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_recibo, prevalence: 12.4056%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_nom_pens, prevalence: 6.8748%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_nomina, prevalence: 5.9256%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_cco_fin, prevalence: 5.7269%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_tjcr_fin, prevalence: 5.6438%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_cno_fin, prevalence: 3.0221%"}
{"timestamp": "2026-01-14 21:26:50,378", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ecue_fin, prevalence: 2.0531%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_dela_fin, prevalence: 1.0983%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_reca_fin, prevalence: 0.7767%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ctma_fin, prevalence: 0.5611%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_valo_fin, prevalence: 0.4048%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ctop_fin, prevalence: 0.3171%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_fond_fin, prevalence: 0.3156%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_deco_fin, prevalence: 0.2664%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ctpp_fin, prevalence: 0.1986%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_plan_fin, prevalence: 0.0517%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ctju_fin, prevalence: 0.0390%"}
{"timestamp": "2026-01-14 21:26:50,379", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_deme_fin, prevalence: 0.0217%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_pres_fin, prevalence: 0.0121%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_cder_fin, prevalence: 0.0114%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_hip_fin, prevalence: 0.0062%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_viv_fin, prevalence: 0.0055%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_aval_fin, prevalence: 0.0003%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Product: target_ahor_fin, prevalence: 0.0001%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Product groups by prevalence created"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Frequent group: 8 products with prevalence >= 1.0000%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Mid group: 7 products with prevalence 0.1000%-1.0000%"}
{"timestamp": "2026-01-14 21:26:50,380", "module": "modelling_ovr", "level": "INFO", "message": "Rare group: 9 products with prevalence < 0.1000%"}
{"timestamp": "2026-01-14 21:26:50,381", "module": "modelling_ovr", "level": "INFO", "message": "frequent: computed prevalence range [1.0983%, 12.4056%]"}
{"timestamp": "2026-01-14 21:26:50,381", "module": "modelling_ovr", "level": "INFO", "message": "mid: computed prevalence range [0.1986%, 0.7767%]"}
{"timestamp": "2026-01-14 21:26:50,381", "module": "modelling_ovr", "level": "INFO", "message": "rare: computed prevalence range [0.0001%, 0.0517%]"}
{"timestamp": "2026-01-14 21:26:51,090", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-14 21:26:51,722", "module": "modelling_ovr", "level": "INFO", "message": "Training frequent group (8 products)"}
{"timestamp": "2026-01-14 21:26:51,959", "module": "modelling_ovr", "level": "INFO", "message": "Starting Optuna optimization for frequent: 5 trials, timeout=120s"}
{"timestamp": "2026-01-14 21:26:52,035", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 | 3 folds | iterations=150, depth=7, learning_rate=0.120"}
{"timestamp": "2026-01-14 21:39:24,586", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 completed: AUC=0.8986"}
{"timestamp": "2026-01-14 21:39:24,587", "module": "modelling_ovr", "level": "INFO", "message": "[frequent]  | Trial 1/5: AUC=0.8986  | Params: depth=7, learning_rate=0.1203, iterations=150   | Best AUC so far: 0.8986"}
{"timestamp": "2026-01-14 21:39:24,588", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Hyperparameter optimization for frequent group completed"}
{"timestamp": "2026-01-14 21:39:24,588", "module": "modelling_ovr", "level": "INFO", "message": "Best CV AUC of frequent group: 0.8986"}
{"timestamp": "2026-01-14 21:39:25,120", "module": "modelling_ovr", "level": "INFO", "message": "Training frequent group: 8 products (one at a time for memory efficiency)"}
{"timestamp": "2026-01-14 21:39:25,121", "module": "modelling_ovr", "level": "INFO", "message": "[1/8] Training: target_recibo (143,013 positives, 1,009,801 negatives)"}
{"timestamp": "2026-01-14 21:40:59,973", "module": "modelling_ovr", "level": "INFO", "message": "[1/8] Saved: target_recibo"}
{"timestamp": "2026-01-14 21:41:00,053", "module": "modelling_ovr", "level": "INFO", "message": "[2/8] Training: target_nom_pens (79,254 positives, 1,073,560 negatives)"}
{"timestamp": "2026-01-14 21:42:34,211", "module": "modelling_ovr", "level": "INFO", "message": "[2/8] Saved: target_nom_pens"}
{"timestamp": "2026-01-14 21:42:34,289", "module": "modelling_ovr", "level": "INFO", "message": "[3/8] Training: target_nomina (68,311 positives, 1,084,503 negatives)"}
{"timestamp": "2026-01-14 21:44:05,203", "module": "modelling_ovr", "level": "INFO", "message": "[3/8] Saved: target_nomina"}
{"timestamp": "2026-01-14 21:44:05,280", "module": "modelling_ovr", "level": "INFO", "message": "[4/8] Training: target_cco_fin (66,020 positives, 1,086,794 negatives)"}
{"timestamp": "2026-01-14 21:45:41,113", "module": "modelling_ovr", "level": "INFO", "message": "[4/8] Saved: target_cco_fin"}
{"timestamp": "2026-01-14 21:45:41,189", "module": "modelling_ovr", "level": "INFO", "message": "[5/8] Training: target_tjcr_fin (65,062 positives, 1,087,752 negatives)"}
{"timestamp": "2026-01-14 21:47:16,691", "module": "modelling_ovr", "level": "INFO", "message": "[5/8] Saved: target_tjcr_fin"}
{"timestamp": "2026-01-14 21:47:16,768", "module": "modelling_ovr", "level": "INFO", "message": "[6/8] Training: target_cno_fin (34,839 positives, 1,117,975 negatives)"}
{"timestamp": "2026-01-14 21:48:46,711", "module": "modelling_ovr", "level": "INFO", "message": "[6/8] Saved: target_cno_fin"}
{"timestamp": "2026-01-14 21:48:46,785", "module": "modelling_ovr", "level": "INFO", "message": "[7/8] Training: target_ecue_fin (23,668 positives, 1,129,146 negatives)"}
{"timestamp": "2026-01-14 21:50:20,688", "module": "modelling_ovr", "level": "INFO", "message": "[7/8] Saved: target_ecue_fin"}
{"timestamp": "2026-01-14 21:50:20,766", "module": "modelling_ovr", "level": "INFO", "message": "[8/8] Training: target_dela_fin (12,661 positives, 1,140,153 negatives)"}
{"timestamp": "2026-01-14 21:51:42,818", "module": "modelling_ovr", "level": "INFO", "message": "[8/8] Saved: target_dela_fin"}
{"timestamp": "2026-01-14 21:51:42,891", "module": "modelling_ovr", "level": "INFO", "message": "Trained 8/8 products"}
{"timestamp": "2026-01-14 21:51:42,899", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Final OvR model for frequent group trained"}
{"timestamp": "2026-01-14 21:51:47,573", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Thresholds optimization for 8 products completed"}
{"timestamp": "2026-01-14 21:51:47,573", "module": "modelling_ovr", "level": "INFO", "message": "Product thresholds: {'target_recibo': 0.5506611611718659, 'target_nom_pens': 0.7821116168613103, 'target_nomina': 0.8076983807589875, 'target_cco_fin': 0.9074372681063511, 'target_tjcr_fin': 0.5379542227636953, 'target_cno_fin': 0.8768995097639388, 'target_ecue_fin': 0.9312269230733935, 'target_dela_fin': 0.9017012241156888}"}
{"timestamp": "2026-01-14 21:51:47,573", "module": "modelling_ovr", "level": "INFO", "message": "DONE: frequent thresholds optimized"}
{"timestamp": "2026-01-14 21:52:09,078", "module": "modelling_ovr", "level": "INFO", "message": "Training mid group (7 products)"}
{"timestamp": "2026-01-14 21:52:09,318", "module": "modelling_ovr", "level": "INFO", "message": "Starting Optuna optimization for mid: 5 trials, timeout=120s"}
{"timestamp": "2026-01-14 21:52:09,389", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 | 3 folds | iterations=150, depth=7, learning_rate=0.120"}
{"timestamp": "2026-01-14 22:02:31,605", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 completed: AUC=0.8451"}
{"timestamp": "2026-01-14 22:02:31,606", "module": "modelling_ovr", "level": "INFO", "message": "[mid]  | Trial 1/5: AUC=0.8451  | Params: depth=7, learning_rate=0.1203, iterations=150   | Best AUC so far: 0.8451"}
{"timestamp": "2026-01-14 22:02:31,607", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Hyperparameter optimization for mid group completed"}
{"timestamp": "2026-01-14 22:02:31,607", "module": "modelling_ovr", "level": "INFO", "message": "Best CV AUC of mid group: 0.8451"}
{"timestamp": "2026-01-14 22:02:32,224", "module": "modelling_ovr", "level": "INFO", "message": "Training mid group: 7 products (one at a time for memory efficiency)"}
{"timestamp": "2026-01-14 22:02:32,225", "module": "modelling_ovr", "level": "INFO", "message": "[1/7] Training: target_reca_fin (8,954 positives, 1,143,860 negatives)"}
{"timestamp": "2026-01-14 22:03:55,571", "module": "modelling_ovr", "level": "INFO", "message": "[1/7] Saved: target_reca_fin"}
{"timestamp": "2026-01-14 22:03:55,669", "module": "modelling_ovr", "level": "INFO", "message": "[2/7] Training: target_ctma_fin (6,469 positives, 1,146,345 negatives)"}
{"timestamp": "2026-01-14 22:05:24,555", "module": "modelling_ovr", "level": "INFO", "message": "[2/7] Saved: target_ctma_fin"}
{"timestamp": "2026-01-14 22:05:24,656", "module": "modelling_ovr", "level": "INFO", "message": "[3/7] Training: target_valo_fin (4,667 positives, 1,148,147 negatives)"}
{"timestamp": "2026-01-14 22:06:48,249", "module": "modelling_ovr", "level": "INFO", "message": "[3/7] Saved: target_valo_fin"}
{"timestamp": "2026-01-14 22:06:48,345", "module": "modelling_ovr", "level": "INFO", "message": "[4/7] Training: target_ctop_fin (3,656 positives, 1,149,158 negatives)"}
{"timestamp": "2026-01-14 22:08:08,608", "module": "modelling_ovr", "level": "INFO", "message": "[4/7] Saved: target_ctop_fin"}
{"timestamp": "2026-01-14 22:08:08,702", "module": "modelling_ovr", "level": "INFO", "message": "[5/7] Training: target_fond_fin (3,638 positives, 1,149,176 negatives)"}
{"timestamp": "2026-01-14 22:09:29,532", "module": "modelling_ovr", "level": "INFO", "message": "[5/7] Saved: target_fond_fin"}
{"timestamp": "2026-01-14 22:09:29,624", "module": "modelling_ovr", "level": "INFO", "message": "[6/7] Training: target_deco_fin (3,071 positives, 1,149,743 negatives)"}
{"timestamp": "2026-01-14 22:10:47,861", "module": "modelling_ovr", "level": "INFO", "message": "[6/7] Saved: target_deco_fin"}
{"timestamp": "2026-01-14 22:10:47,957", "module": "modelling_ovr", "level": "INFO", "message": "[7/7] Training: target_ctpp_fin (2,289 positives, 1,150,525 negatives)"}
{"timestamp": "2026-01-14 22:12:07,459", "module": "modelling_ovr", "level": "INFO", "message": "[7/7] Saved: target_ctpp_fin"}
{"timestamp": "2026-01-14 22:12:07,553", "module": "modelling_ovr", "level": "INFO", "message": "Trained 7/7 products"}
{"timestamp": "2026-01-14 22:12:07,559", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Final OvR model for mid group trained"}
{"timestamp": "2026-01-14 22:12:11,774", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Thresholds optimization for 7 products completed"}
{"timestamp": "2026-01-14 22:12:11,775", "module": "modelling_ovr", "level": "INFO", "message": "Product thresholds: {'target_reca_fin': 0.8891970465281744, 'target_ctma_fin': 0.9520002042760739, 'target_valo_fin': 0.4299951042835305, 'target_ctop_fin': 0.349202698072479, 'target_fond_fin': 0.519194029507469, 'target_deco_fin': 0.5, 'target_ctpp_fin': 0.6327204599116413}"}
{"timestamp": "2026-01-14 22:12:11,775", "module": "modelling_ovr", "level": "INFO", "message": "DONE: mid thresholds optimized"}
{"timestamp": "2026-01-14 22:12:30,030", "module": "modelling_ovr", "level": "INFO", "message": "Training rare group (9 products)"}
{"timestamp": "2026-01-14 22:12:30,294", "module": "modelling_ovr", "level": "INFO", "message": "Starting Optuna optimization for rare: 5 trials, timeout=120s"}
{"timestamp": "2026-01-14 22:12:30,366", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 | 3 folds | iterations=150, depth=7, learning_rate=0.120"}
{"timestamp": "2026-01-14 22:25:19,096", "module": "modelling_ovr", "level": "INFO", "message": "Trial 1 completed: AUC=0.7186"}
{"timestamp": "2026-01-14 22:25:19,097", "module": "modelling_ovr", "level": "INFO", "message": "[rare]  | Trial 1/5: AUC=0.7186  | Params: depth=7, learning_rate=0.1203, iterations=150   | Best AUC so far: 0.7186"}
{"timestamp": "2026-01-14 22:25:19,098", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Hyperparameter optimization for rare group completed"}
{"timestamp": "2026-01-14 22:25:19,099", "module": "modelling_ovr", "level": "INFO", "message": "Best CV AUC of rare group: 0.7186"}
{"timestamp": "2026-01-14 22:25:19,641", "module": "modelling_ovr", "level": "INFO", "message": "Training rare group: 9 products (one at a time for memory efficiency)"}
{"timestamp": "2026-01-14 22:25:19,642", "module": "modelling_ovr", "level": "INFO", "message": "[1/9] Training: target_plan_fin (596 positives, 1,152,218 negatives)"}
{"timestamp": "2026-01-14 22:26:27,829", "module": "modelling_ovr", "level": "INFO", "message": "[1/9] Saved: target_plan_fin"}
{"timestamp": "2026-01-14 22:26:27,925", "module": "modelling_ovr", "level": "INFO", "message": "[2/9] Training: target_ctju_fin (450 positives, 1,152,364 negatives)"}
{"timestamp": "2026-01-14 22:27:38,218", "module": "modelling_ovr", "level": "INFO", "message": "[2/9] Saved: target_ctju_fin"}
{"timestamp": "2026-01-14 22:27:38,313", "module": "modelling_ovr", "level": "INFO", "message": "[3/9] Training: target_deme_fin (250 positives, 1,152,564 negatives)"}
{"timestamp": "2026-01-14 22:28:47,464", "module": "modelling_ovr", "level": "INFO", "message": "[3/9] Saved: target_deme_fin"}
{"timestamp": "2026-01-14 22:28:47,562", "module": "modelling_ovr", "level": "INFO", "message": "[4/9] Training: target_pres_fin (140 positives, 1,152,674 negatives)"}
{"timestamp": "2026-01-14 22:29:53,432", "module": "modelling_ovr", "level": "INFO", "message": "[4/9] Saved: target_pres_fin"}
{"timestamp": "2026-01-14 22:29:53,530", "module": "modelling_ovr", "level": "INFO", "message": "[5/9] Training: target_cder_fin (131 positives, 1,152,683 negatives)"}
{"timestamp": "2026-01-14 22:30:57,286", "module": "modelling_ovr", "level": "INFO", "message": "[5/9] Saved: target_cder_fin"}
{"timestamp": "2026-01-14 22:30:57,383", "module": "modelling_ovr", "level": "INFO", "message": "[6/9] Training: target_hip_fin (72 positives, 1,152,742 negatives)"}
{"timestamp": "2026-01-14 22:32:01,748", "module": "modelling_ovr", "level": "INFO", "message": "[6/9] Saved: target_hip_fin"}
{"timestamp": "2026-01-14 22:32:01,844", "module": "modelling_ovr", "level": "INFO", "message": "[7/9] Training: target_viv_fin (63 positives, 1,152,751 negatives)"}
{"timestamp": "2026-01-14 22:33:04,546", "module": "modelling_ovr", "level": "INFO", "message": "[7/9] Saved: target_viv_fin"}
{"timestamp": "2026-01-14 22:33:04,641", "module": "modelling_ovr", "level": "INFO", "message": "[8/9] Training: target_aval_fin (4 positives, 1,152,810 negatives)"}
{"timestamp": "2026-01-14 22:34:04,724", "module": "modelling_ovr", "level": "INFO", "message": "[8/9] Saved: target_aval_fin"}
{"timestamp": "2026-01-14 22:34:04,821", "module": "modelling_ovr", "level": "INFO", "message": "[9/9] Training: target_ahor_fin (1 positives, 1,152,813 negatives)"}
{"timestamp": "2026-01-14 22:35:03,835", "module": "modelling_ovr", "level": "INFO", "message": "[9/9] Saved: target_ahor_fin"}
{"timestamp": "2026-01-14 22:35:03,931", "module": "modelling_ovr", "level": "INFO", "message": "Trained 9/9 products"}
{"timestamp": "2026-01-14 22:35:03,938", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Final OvR model for rare group trained"}
{"timestamp": "2026-01-14 22:35:09,183", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Thresholds optimization for 9 products completed"}
{"timestamp": "2026-01-14 22:35:09,183", "module": "modelling_ovr", "level": "INFO", "message": "Product thresholds: {'target_plan_fin': 0.3478732582190908, 'target_ctju_fin': 0.9773621472939723, 'target_deme_fin': 0.5, 'target_pres_fin': 0.05948394066220527, 'target_cder_fin': 0.014598839192869887, 'target_hip_fin': 0.012547400210707115, 'target_viv_fin': 0.29160478369781817, 'target_aval_fin': 0.5, 'target_ahor_fin': 2.543874980405198e-08}"}
{"timestamp": "2026-01-14 22:35:09,183", "module": "modelling_ovr", "level": "INFO", "message": "DONE: rare thresholds optimized"}
{"timestamp": "2026-01-14 22:35:31,958", "module": "modelling_ovr", "level": "INFO", "message": "Starting retraining on full data"}
{"timestamp": "2026-01-14 22:35:33,872", "module": "modelling_ovr", "level": "INFO", "message": "Full data loaded: 12,677,703 rows x 103 columns"}
{"timestamp": "2026-01-14 22:35:38,097", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Full data prepared for model retraining"}
{"timestamp": "2026-01-14 22:35:38,097", "module": "modelling_ovr", "level": "INFO", "message": "Full data features: (12677703, 77), targets: (12677703, 24)"}
{"timestamp": "2026-01-14 22:37:57,657", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-14 22:38:00,104", "module": "modelling_ovr", "level": "INFO", "message": "Applied feature selection to full data: 27 features"}
{"timestamp": "2026-01-14 22:38:00,104", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Categorical features and their indices retrieved"}
{"timestamp": "2026-01-14 22:38:00,105", "module": "modelling_ovr", "level": "INFO", "message": "Categorical features: ['ind_empleado', 'pais_residencia', 'sexo', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'canal_entrada', 'indfall', 'cod_prov', 'ind_actividad_cliente', 'segmento', 'ind_ahor_fin_ult1_lag3', 'ind_aval_fin_ult1_lag3', 'ind_cco_fin_ult1_lag3', 'ind_cder_fin_ult1_lag3', 'ind_cno_fin_ult1_lag3', 'ind_ctju_fin_ult1_lag3', 'ind_ctma_fin_ult1_lag3', 'ind_ctop_fin_ult1_lag3', 'ind_ctpp_fin_ult1_lag3', 'ind_deco_fin_ult1_lag3', 'ind_ahor_fin_ult1_lag6', 'ind_aval_fin_ult1_lag6', 'ind_cco_fin_ult1_lag6', 'ind_cder_fin_ult1_lag6', 'ind_cno_fin_ult1_lag6', 'ind_ctju_fin_ult1_lag6', 'ind_ctma_fin_ult1_lag6', 'ind_ctop_fin_ult1_lag6', 'ind_ctpp_fin_ult1_lag6', 'ind_deco_fin_ult1_lag6']"}
{"timestamp": "2026-01-14 22:38:00,105", "module": "modelling_ovr", "level": "INFO", "message": "Categorical feature indices: [0, 1, 4, 8, 9, 11, 12, 20, 24, 25, 26]"}
{"timestamp": "2026-01-14 22:38:00,105", "module": "modelling_ovr", "level": "INFO", "message": "Retraining FREQUENT group (8 products) on full data"}
{"timestamp": "2026-01-14 22:38:00,358", "module": "modelling_ovr", "level": "INFO", "message": "[1/8] Retraining: target_recibo (153,176 positives)"}
{"timestamp": "2026-01-14 22:53:58,596", "module": "modelling_ovr", "level": "INFO", "message": "[2/8] Retraining: target_nom_pens (84,767 positives)"}
{"timestamp": "2026-01-14 23:08:58,031", "module": "modelling_ovr", "level": "INFO", "message": "[3/8] Retraining: target_nomina (73,799 positives)"}
{"timestamp": "2026-01-14 23:23:47,159", "module": "modelling_ovr", "level": "INFO", "message": "[4/8] Retraining: target_cco_fin (69,874 positives)"}
{"timestamp": "2026-01-14 23:38:55,334", "module": "modelling_ovr", "level": "INFO", "message": "[5/8] Retraining: target_tjcr_fin (69,310 positives)"}
{"timestamp": "2026-01-14 23:53:43,486", "module": "modelling_ovr", "level": "INFO", "message": "[6/8] Retraining: target_cno_fin (37,185 positives)"}
{"timestamp": "2026-01-15 00:08:08,006", "module": "modelling_ovr", "level": "INFO", "message": "[7/8] Retraining: target_ecue_fin (26,377 positives)"}
{"timestamp": "2026-01-15 00:22:06,338", "module": "modelling_ovr", "level": "INFO", "message": "[8/8] Retraining: target_dela_fin (12,707 positives)"}
{"timestamp": "2026-01-15 00:35:20,921", "module": "modelling_ovr", "level": "INFO", "message": "frequent group retrained on full data: 8 products"}
{"timestamp": "2026-01-15 00:35:20,921", "module": "modelling_ovr", "level": "INFO", "message": "Retraining MID group (7 products) on full data"}
{"timestamp": "2026-01-15 00:35:21,200", "module": "modelling_ovr", "level": "INFO", "message": "[1/7] Retraining: target_reca_fin (9,233 positives)"}
{"timestamp": "2026-01-15 00:48:07,866", "module": "modelling_ovr", "level": "INFO", "message": "[2/7] Retraining: target_ctma_fin (6,981 positives)"}
{"timestamp": "2026-01-15 01:01:25,262", "module": "modelling_ovr", "level": "INFO", "message": "[3/7] Retraining: target_valo_fin (4,850 positives)"}
{"timestamp": "2026-01-15 01:13:50,937", "module": "modelling_ovr", "level": "INFO", "message": "[4/7] Retraining: target_ctop_fin (3,882 positives)"}
{"timestamp": "2026-01-15 01:26:45,047", "module": "modelling_ovr", "level": "INFO", "message": "[5/7] Retraining: target_fond_fin (3,698 positives)"}
{"timestamp": "2026-01-15 01:39:16,312", "module": "modelling_ovr", "level": "INFO", "message": "[6/7] Retraining: target_deco_fin (3,071 positives)"}
{"timestamp": "2026-01-15 01:51:35,166", "module": "modelling_ovr", "level": "INFO", "message": "[7/7] Retraining: target_ctpp_fin (2,420 positives)"}
{"timestamp": "2026-01-15 02:04:19,898", "module": "modelling_ovr", "level": "INFO", "message": "mid group retrained on full data: 7 products"}
{"timestamp": "2026-01-15 02:04:19,898", "module": "modelling_ovr", "level": "INFO", "message": "Retraining RARE group (9 products) on full data"}
{"timestamp": "2026-01-15 02:04:20,546", "module": "modelling_ovr", "level": "INFO", "message": "[1/9] Retraining: target_plan_fin (618 positives)"}
{"timestamp": "2026-01-15 02:15:39,190", "module": "modelling_ovr", "level": "INFO", "message": "[2/9] Retraining: target_ctju_fin (490 positives)"}
{"timestamp": "2026-01-15 02:27:46,200", "module": "modelling_ovr", "level": "INFO", "message": "[3/9] Retraining: target_deme_fin (250 positives)"}
{"timestamp": "2026-01-15 02:39:03,011", "module": "modelling_ovr", "level": "INFO", "message": "[4/9] Retraining: target_pres_fin (147 positives)"}
{"timestamp": "2026-01-15 02:50:11,427", "module": "modelling_ovr", "level": "INFO", "message": "[5/9] Retraining: target_cder_fin (136 positives)"}
{"timestamp": "2026-01-15 03:01:09,771", "module": "modelling_ovr", "level": "INFO", "message": "[6/9] Retraining: target_hip_fin (75 positives)"}
{"timestamp": "2026-01-15 03:12:12,595", "module": "modelling_ovr", "level": "INFO", "message": "[7/9] Retraining: target_viv_fin (70 positives)"}
{"timestamp": "2026-01-15 03:22:44,873", "module": "modelling_ovr", "level": "INFO", "message": "[8/9] Retraining: target_aval_fin (4 positives)"}
{"timestamp": "2026-01-15 03:32:36,074", "module": "modelling_ovr", "level": "INFO", "message": "[9/9] Retraining: target_ahor_fin (2 positives)"}
{"timestamp": "2026-01-15 03:42:18,442", "module": "modelling_ovr", "level": "INFO", "message": "rare group retrained on full data: 9 products"}
{"timestamp": "2026-01-15 03:42:18,442", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Retraining on full data completed"}
{"timestamp": "2026-01-15 03:42:19,679", "module": "modelling_ovr", "level": "INFO", "message": "Thresholds saved to: results/ovr_group_thresholds.json"}
{"timestamp": "2026-01-15 03:42:19,679", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Training completed: 3 group models"}
{"timestamp": "2026-01-15 03:42:19,967", "module": "modelling_ovr", "level": "INFO", "message": "Evaluating OvR Grouped model"}
{"timestamp": "2026-01-15 03:42:20,653", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-15 03:42:21,070", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-15 03:42:34,982", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Predictions for all products completed"}
{"timestamp": "2026-01-15 03:42:36,394", "module": "modelling_ovr", "level": "INFO", "message": "DONE: MAP@K calculation completed"}
{"timestamp": "2026-01-15 03:42:36,898", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Precision@K calculation completed"}
{"timestamp": "2026-01-15 03:42:38,188", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Precision@K with thresholds calculation completed"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Evaluation completed"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "Metrics: Mean AUC: 0.9025 +/- 0.0753  | MAP@7: 0.7659  | Precision@7: 0.0570  | Precision@7 (with thresholds): 0.0564"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Evaluation done for group: frequent"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "frequent: AUC=0.9018 (8 products)"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Evaluation done for group: mid"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "mid: AUC=0.8490 (6 products)"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Evaluation done for group: rare"}
{"timestamp": "2026-01-15 03:42:38,193", "module": "modelling_ovr", "level": "INFO", "message": "rare: AUC=0.9491 (7 products)"}
{"timestamp": "2026-01-15 03:42:38,194", "module": "modelling_ovr", "level": "INFO", "message": "Evaluation results saved to: results/ovr_grouped_evaluation_20260115_034238.json"}
{"timestamp": "2026-01-15 03:42:38,308", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Data prepared for model training"}
{"timestamp": "2026-01-15 03:42:38,348", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Predictions for all products completed"}
{"timestamp": "2026-01-15 03:42:38,350", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Top-K recommendations for 100 customers completed"}
{"timestamp": "2026-01-15 03:42:38,350", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Recommendations for 100 customers completed"}
{"timestamp": "2026-01-15 03:42:38,448", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Models saved to: models/ovr_grouped_catboost"}
{"timestamp": "2026-01-15 03:42:38,546", "module": "modelling_ovr", "level": "INFO", "message": "MLflow tracking URI: http://localhost:5000"}
{"timestamp": "2026-01-15 03:42:38,569", "module": "modelling_ovr", "level": "INFO", "message": "MLflow experiment set to: bank_products_recommendation"}
{"timestamp": "2026-01-15 03:42:38,570", "module": "modelling_ovr", "level": "INFO", "message": "OvRGroupModel initialized"}
{"timestamp": "2026-01-15 03:42:38,570", "module": "modelling_ovr", "level": "INFO", "message": "Hyperparameters optimization settings: n_splits=3, max_iter=300, early_stop=30"}
{"timestamp": "2026-01-15 03:42:38,570", "module": "modelling_ovr", "level": "INFO", "message": "Models training settings: boosting=Plain, border_count=128, threads=-1"}
{"timestamp": "2026-01-15 03:42:38,570", "module": "modelling_ovr", "level": "INFO", "message": "Feature selection settings: enabled=True, min_importance=0.001"}
{"timestamp": "2026-01-15 03:42:38,589", "module": "modelling_ovr", "level": "INFO", "message": "DONE: Loaded 3 group models from: models/ovr_grouped_catboost"}
